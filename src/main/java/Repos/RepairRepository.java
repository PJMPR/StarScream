package Repos;

import Computer.Repair;
import Repos.Mappers.IMapRSIntoEntity;
import Repos.UOW.IUnitOfWork;

import java.sql.Connection;
import java.sql.SQLException;
import java.util.List;

public class RepairRepository extends BaseRepository<Repair> implements IRepairRepository{
    public RepairRepository(Connection connection, IMapRSIntoEntity<Repair> mapper, IUnitOfWork uow){
        super(connection, mapper, uow);
    }

    @Override
    protected String CreateTableSQL() {
        return   "CREATE TABLE Repair(" +
                "ID int GENERATED BY DEFAULT AS IDENTITY," +
                "ProfileID int," +
                "NameOfDevice VARCHAR(50)," +
                "DateOfAcceptance date," +
                "ExpectedDateOfReception date," +
                "Price int" +
                ")";
    }

    @Override
    protected String tableName(){
        return "Repair";
    }

    @Override
    protected String InsertSQL(){
        return "INSERT INTO Repair(ProfileID,  NameOfDevice, DateOfAcceptance, ExpectedDateOfReception, Price) VALUES (?, ?, ?, ?, ?)";
    }

    @Override
    protected String UpdateSQL(){
        return "UPDATE Repair set ProfileID = ?, NameOfDevice = ?, DateOfAcceptance = ?, ExpectedDateOfReception = ?, Price = ? WHERE ID = ?";
    }

    /*
        Select by ProfileID
    */
    protected String SelectByProfileID(){
        return "SELECT * FROM"
                + tableName()
                + "WHERE ProfileID = ?";
        }

    @Override
    protected void setupInsert(Repair entity) throws SQLException{
        Insert.setInt(1, entity.getProfileID());
        Insert.setString(2, entity.getNameOfDeviceInRepair());
        Insert.setDate(3, entity.getStartRepairDate());
        Insert.setDate(4, entity.getEndRepairDate());
        Insert.setInt(5, entity.getPrice());
    }

    @Override
    protected void setupUpdate(Repair entity) throws SQLException{

        Update.setInt(1, entity.getID());
        Update.setInt(2, entity.getProfileID());
        Update.setString(3, entity.getNameOfDeviceInRepair());
        Update.setDate(4, entity.getStartRepairDate());
        Update.setDate(5, entity.getEndRepairDate());
        Update.setInt(6, entity.getPrice());
    }

    public List<Repair> repairs(String repair) {
        return null;
    }
}